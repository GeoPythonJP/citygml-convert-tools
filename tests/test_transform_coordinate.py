#!/usr/bin/env python
# coding: utf-8

import pytest
from pytest import approx

from py_plateau.building import Building

line_HNAP0664_b_0 = [
    [35.533096948566886, 139.7963519674318, 3.66410811],
    [35.53309215110142, 139.79634196185296, 3.66408749],
    [35.53312183726169, 139.79632067879015, 3.6635608],
    [35.53312663453339, 139.79633068408438, 3.66358141],
    [35.53314158466162, 139.79631996558618, 3.66331703],
    [35.533175221159944, 139.7963901364649, 3.66346657],
    [35.533160279972336, 139.79640085582636, 3.66373085],
    [35.53316408451471, 139.7964087906811, 3.66374829],
    [35.53313440429897, 139.79643008508884, 3.66427499],
    [35.533130599460456, 139.79642214971136, 3.66425755],
    [35.533115953337905, 139.79643265736863, 3.6645183],
    [35.5330823072676, 139.7963624645014, 3.66436872],
    [35.533096948566886, 139.7963519674318, 3.66410811],
]

line_HNAP0664_b_0_a = [
    [-51799.26961284785, -3353.5845957979486, 3.66410811],
    [-51799.801499817906, -3354.4921323657695, 3.66408749],
    [-51796.50741412865, -3356.420910066282, 3.6635608],
    [-51795.97554883826, -3355.5133995360065, 3.66358141],
    [-51794.316627467706, -3356.484763087701, 3.66331703],
    [-51790.58740524861, -3350.1200557466364, 3.66346657],
    [-51792.24533409834, -3349.148612766896, 3.66373085],
    [-51791.82353042733, -3348.428898056156, 3.66374829],
    [-51795.11695531808, -3346.499089385544, 3.66427499],
    [-51795.538791977975, -3347.218851687374, 3.66425755],
    [-51797.1639790087, -3346.2665933643902, 3.6645183],
    [-51800.89426509801, -3352.6332981565643, 3.66436872],
    [-51799.26961284785, -3353.5845957979486, 3.66410811],
]


def test_transform_coordinate():
    from_srid = "6697"
    to_srid = "6677"

    obj_building = Building(from_srid, to_srid)

    for index, row in enumerate(line_HNAP0664_b_0):
        latitude = row[0]
        longitude = row[1]
        height = row[2]
        xx, yy, zz = obj_building.transform_coordinate(latitude, longitude, height)

        xx_a = line_HNAP0664_b_0_a[index][0]
        yy_a = line_HNAP0664_b_0_a[index][1]
        zz_a = line_HNAP0664_b_0_a[index][2]

        assert xx == approx(xx_a), f"xx={xx}, xx_a={xx_a}"
        assert yy == approx(yy_a), f"yy={yy}, zz_a={yy_a}"
        assert zz == approx(zz_a), f"zz={zz}, zz_a={zz_a}"
